<!DOCTYPE html>
<html lang="en" xml:lang="en" xmlns= "http://www.w3.org/1999/xhtml">
  <head>
    <title>PaleoDB Navigator</title>

    <meta charset="utf-8"/>
    <meta http-equiv="Content-Language" content="en" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
    <meta name="author" content="John J Czaplewski"/>

    <link href="css/bootstrapRC2.min.css" rel="stylesheet"/>
    <link href="css/typeahead.css" rel="stylesheet"/>
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet"/>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.3/leaflet.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href="css/timescale.css" rel="stylesheet"/>
    <link href="css/taxaBrowser.css" rel="stylesheet" />
    <style>
    /*navMap styles */
    body {
      font-family: 'Open-sans', sans-serif;
    }
    .row {
      margin-left: 0;
      margin-right: 0;
    }
    #wrap {
      min-height: 100%;
      height: auto !important;
      height: 100%;
      margin: 0 auto -5em;
      padding: 0 0 5em;
    }
    #graphicRow {
      width:100%;
    }
    #mapContainer {
      display: inline;
      position: relative;
    }
    #map {
      height:400px;
      width:100%;
    }
    #mapControlCover {
      position: absolute;
      z-index: 2000;
      width:46px;
      display: none;
    }
    #controlCover1 {
      height:97px;
      background-color:rgba(0,0,0,0.4);
    }
    #controlCover2 {
      position: absolute;
      width:46px;
      height:181px;
      top: 142px;
      background-color:rgba(0,0,0,0.4);
    }
    #mapControls {
      position: absolute;
      z-index: 1000;
      pointer-events: none;
    }
    .countries {
      stroke: #000;
      fill: #FEFBFB;
      stroke-width: 0.5;
    }
    .bins {
      fill: #EFEE69;
      stroke: none;
      opacity:0.7;
    }
    .bins:hover {
      stroke:#222;
      stroke-width:1px;
    }
    .svgbins {
      fill: #EFEE69;
      stroke: none;
      opacity:0.7;
    }
    .svgbins:hover {
      stroke:#222;
      stroke-width:1px;
    }
    .clusters {
      fill: #72BBDF;
      stroke: none;
      opacity:0.7;
    }
    .clusters:hover {
      stroke:#222;
      stroke-width:1px;
    }
    #infoContainer {
      position: relative;
    }
    .info {
      background-color: white;
      padding:10px;
      display:none;
      border-top: 1px solid #ccc;
      border-right: 1px solid #ccc;
      font-size:0.8em;
      width:16em;
      bottom:0;
      position: absolute;
      z-index: 1;
    }
    
    .time {
      height:30px;
      width:30px;
      /*margin-top:15px;*/
      cursor: pointer;
    }
    .timeToggler.leaflet-control {
      left:50px;
      margin-top:130px;
      position: absolute;
      width:170px;
      padding:10px;
      vertical-align: middle;
      display:none;
    }
    .rotate {
      height:30px;
      width:30px;
      margin-top:15px;
      cursor: pointer;
      margin:0;
      margin-top: 7px;
    }
    #rotateIcon {
      height:30px;
      width:30px;
      cursor: pointer;
      background-repeat: no-repeat;
      background-size: cover;
      background-image: url('./img/pangea.png');
      margin: auto;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
    }
    .reconstructToggler.leaflet-control {
      left:50px;
      margin-top:130px;
      position: absolute;
      width:170px;
      padding:10px;
      vertical-align: middle;
      display:none;
    }
    .save > a {
      color:#000;
    }
    .save > a:hover {
      color:#000;
    }
    .userToggler.leaflet-control {
      left:45px;
      margin-top:235px;
      position: absolute;
      width:16em;
      padding:10px;
      vertical-align: middle;
      font-size: 0.8em;
      display:none;
    }
    .taxaToggler.leaflet-control {
      left:45px;
      margin-top:187px;
      position: absolute;
      width:18em;
      padding:10px;
      vertical-align: middle;
      font-size: 0.8em;
      display:none;
    }
    .filters {
      position: absolute;
      z-index: 2;
      padding: 10px;
      background-color: rgba(255,255,255,0.95);
      border: 1px solid #ccc;
      text-align: center;
      display: none;
      right:15px;
      bottom:16px;
    }
    .filters > p {
      display: inline;
    }
    .filter {
      display: none;
      border: 1px solid #aaa;
      border-radius: 4px;
      padding: 5px;
      background-color: #fff;
      color: #777;
      margin-top:3px;
    }
    .filter > button {
      float:left;
      margin-right:5px;
    }
    .info.leaflet-control {
      margin-left: 0;
    }
    .info.leaflet-control {
      margin-bottom: 0;
    }
    .customControl {
      background-color: rgba(255,255,255,0.95);
      font-weight: bold;
      border-right:1px solid #ccc;
      border-bottom: 1px solid #ccc;
      line-height: 1;
    }
    .mapCtrl {
      height:45px;
      width:45px;
      display: block;
      position: relative;
      text-align: center;
      cursor: pointer;
    }
    .mapCtrl:hover {
      /*background-color:#ccc;
      box-shadow: inset 3px 0 0 #ff992c;*/
    }
    .mapCtrl > i {
      margin: auto;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      height: 25px;
    }
    .mapCtrl > a > i {
      margin: auto;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      height: 25px;
    }
    .mapCtrl > .icon-minus {
      height:16px;
    }
    .mapCtrl > .icon-plus {
      height:16px;
    }
    .collection {
      fill: #EFEE69;
      stroke: none;
      opacity:0.7;
    }
    .collection:hover {
      stroke:#222;
      stroke-width:1px;
    }
    /*#window {
      background-color:rgba(255,255,255,0.95);
      height:384px;
      width:25%;
      z-index: 10;
      float:right;
      position: absolute;
      top:0;
      right:0;
      overflow-y:scroll;
      padding:1.5em;
      box-shadow: -1px -6px 12px #777;
      -moz-box-shadow: -1px -6px 12px #777;
      -webkit-box-shadow: -1px -6px 12px #777;
      display:none;
    }
    #windowCollapse {
      position: absolute;
      background-color:rgba(255,255,255,0.95);
      z-index: 11;
      float:right;
      top:10px;
      right:24.9%;
      box-shadow: -4px 0px 8px -2px #777;
      -moz-box-shadow: -4px 0px 8px -2px #777;
      -webkit-box-shadow: -4px 0px 8px -2px #777;
      color:#777;
      padding:5px 5px 5px 9px;
      border-radius: 2px 0 0 2px;
      -moz-border-radius: 2px 0 0 2px;
      -webkit-border-radius: 2px 0 0 2px;
      cursor: pointer;
      display: none;
    }
    #windowCollapse:hover {
      color:#000;
    }*/
    td {
      font-size: 0.8em;
      color:#555;
    }
    td:first-child {
      width:150px;
    }
    #stats {
      width:100%;
      display: table;
    }
    .statContainer {
      text-align: center;
      display:table-cell;
      width:14.2857%;
      padding-bottom: 10px;
      border-left:2px dotted white;
      background-color:#bbb;
      color:#fff;
    }
    .statContainer:hover {
      background-color:#5BBBD5;
    }
    #clusterTable {
      cursor: pointer;
    }
    .firstRow {
      border-top: 0;
    }
    /*Reconstruct map */
    .stroke {
      fill: none;
      stroke: #000;
      stroke-width: 3px;
    }
    .fill {
      fill: #000;
    }
    #reconstructMap {
      width:100%;
      display: none;
    }
   /* #reconstructMapInfo {
      position: absolute;
      width: 18em;
      border-right: 1px solid #aaa;
      border-bottom: 1px solid #aaa;
      padding: 15px;
      background-color:rgba(255,255,255,0.9);
    }*/
    #gplatesLogo {
      height:35px;
      float:left;
      margin-right:10px;
      display: inline;
    }
    #gplatesText {
      font-size: 1em;
      margin-top:11px;
      display: inline;
    }
    #reconstructMapStats {
      display: inline;
    }
    #reconstructMapRefContainerContainer {
      position: absolute;
      right:0;
    }
    #reconstructMapRefContainer {
       position: relative;
    }
    #reconstructMapReference {
      background-color: rgba(255,255,255,0.9);
      padding:6px 0 0 10px;
      border-top: 1px solid #ccc;
      border-left: 1px solid #ccc;
      font-size:0.8em;
      width:21em;
      bottom:0;
      right:1.2em;
      position: absolute;
    }
    .plates {
      fill: #fff;
      stroke:#777;
      stroke-width:.75px;
      opacity:1;
    }
    #interval {
      text-align: center;
      display: inline;
    }
    #age {
      text-align: center;
      display: inline;
      font-size: 0.8em;
    }

    #loading {
      height:42px;
      position: absolute;
      top:1em;
      right:2em;
      z-index: 100;
      display: none;
    }
    .panel-default {
      border:none;
    }
    .panel {
      border: none;
      box-shadow: none;
      -webkit-box-shadow:none;
      -moz-box-shadow:none;
    }
    .panel-default>.panel-heading {
      background-color: #f7f7f7;
    }
    .panel-group .panel {
      border-radius: 2px;
      border-bottom: 1px solid #eee;
    }
    .panel-heading {
      padding:7px 15px;
    }
    .panel-title {
      font-size: 0.95em;
      font-weight: 200;
      color:#555;
    }
    .panel-title:hover {
      color:#111;
    }
    .accordion-toggle:hover {
      text-decoration: none;
    }
    #taxaBrowser {
      display: none;
    }
    .taxonTitle {
      color:#000;
    }
    </style>
    
  </head>

  <body>
    <div id="wrap">
      <div class="row" id="graphicRow">

        <div class="col-sm-3" id="taxaBrowser">
          <div class="browser">
            <form id="taxaSearch">
              <input type="text" class="form-control" id="taxonInput" placeholder="Enter a taxonomic name:"/>
            </form>

            <div name="focal_taxon_box">
              <table class="table table-hover">
                <tbody id="focalTaxonParents"></tbody>
              </table>
            </div>

            <div class="focalTaxon" name="focal_taxon_box">
              <table class="table table-hover">
                <tr class="active">
                  <td>
                    <a class="taxonTitle"></a><br>
                    <p class="taxonAttr"></p>
                  </td>
                </tr>
              </table>
            </div>

            <div class="taxonChildren">
              <table class="table table-hover table-condensed">
                <tbody id="focal_taxon_children"></tbody>
              </table>
            </div>
          </div>
        </div>

      	<div class="col-sm-12" id="graphics">
          <img src="img/loading.gif" id="loading"/>
          <div class="filters">
            <p><strong id="filterTitle">Filters</strong></p>
            <div id="selectedInterval" class="filter"></div>
            <div id="personFilter" class="filter"></div>
            <div id="taxon" class="filter"></div>
          </div>
          <div id="mapControlCover">
            <div id="controlCover1"></div>
            <div id="controlCover2"></div>
          </div>
          <div id="mapControls">
            <div class="customControl buttons leaflet-control">
              <div class="zoom-in mapCtrl"><i class="icon-plus ctrlButton"></i></div>
              <div class="zoom-out mapCtrl"><i class="icon-minus ctrlButton"></i></div>
              <!--<div class="layers"></div>-->
              <div class="rotate mapCtrl"><div id="rotateIcon"></div></div>
              <div class="time mapCtrl"><i class="icon-time icon-2x ctrlButton"></i></div>
              <div class="taxa mapCtrl"><i class="icon-bug icon-2x ctrlButton"></i></div>
              <div class="userFilter mapCtrl"><i class="icon-user icon-2x ctrlButton"></i></div>
              <!--<div class="filt mapCtrl"><i class="icon-filter icon-2x ctrlButton"></i></a></div>-->
              <div class="save mapCtrl"><a data-toggle="modal" href="#saveBox"><i class="icon-save icon-2x ctrlButton"></i></a></div>
              
            </div>

            <div class="customControl timeToggler leaflet-control">
              <form action="">
                <input id="viewByTimeBox" type="checkbox" value="1"/>Filter by time
              </form>
            </div>
            <div class="customControl reconstructToggler leaflet-control">
              <form action="">
                <input id="reconstructBox" type="checkbox" value="1"/>Rotate view by interval
              </form>
            </div>
            <div class="customControl taxaToggler leaflet-control">
              <form id="taxaForm">
                <input type="text" id="taxaInput" placeholder="Enter a taxon" size="16"/>
                <button class="btn btn-primary btn-sm" type="submit">Filter</button>
              </form>
              <a href="#" id="taxaBrowserToggle" style="color:#777;">Expand taxa browser<i class="icon-double-angle-right" style="margin-left:5px;"></i></a>
            </div>
            <div class="customControl userToggler leaflet-control">
             <!-- <form onSubmit="return navMap.filterByPerson()">-->
              <form>
                <input type="text" id="personInput" placeholder="Enter an authorizer" size="22"/>
              </form>
            </div>
            <div id="infoContainer">
              <div class="info leaflet-control"></div>
            </div>
          </div>

          <div id="mapContainer">
            <div id="svgMap"></div>
            <div id="map"></div>
            <div id="reconstructMap">
             <!-- <div id='reconstructMapInfo'></div>-->
              <div id="reconstructMapRefContainerContainer">
                <div id="reconstructMapRefContainer">
                  <div id="reconstructMapReference">
                    <a data-toggle="modal" href='#gPlatesBox'>
                      <img id='gplatesLogo' src='img/gplates_icon.jpg'>
                    </a>
                    <!--<p id="gplatesText">via GPlates</p>-->
                    <div id="reconstructMapStats">
                      <h5 id="interval"></h5>
                      <p id='age'></p>
                    </div>
                    <!--<br>
                    <a id='mapSwitch' href='#'><i class=icon-circle-arrow-left icon-2x></i> Back to main map</a>-->
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!--<div id="windowCollapse"><i class="icon-double-angle-right"></i></div>
          <div id="window" class="col-3 col-offset-9">
            <table class="table-hover table-condensed" id="clusterTable"></table>
          </div>-->
          <div id="time"></div>
        </div> <!-- End col-12 -->
      </div> <!-- End row -->
    </div>

    <div class="modal fade" id="saveBox" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3 class="modal-title">Download Current View</h3>
            <p class="text-muted" id="downloadCount"></p>
          </div>
          <div class="modal-body">
            <h4>Filters:</h4>
            <ul id="filterList"></ul>
            <br>
            <div class="row">
              <div class="col-sm-6">
                <h4>Additional information:</h4>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" id="loc">Location
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" id="ref">Reference
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" id="t">Time
                  </label>
                </div>
              </div>
              <div class="col-sm-6">
                <h4>Format:</h4>
                <div class="radio">
                  <label>
                    <input type="radio" name="format" id="tsv" checked>
                    Tab-separated (TSV)
                  </label>
                </div>
                <div class="radio">
                  <label>
                    <input type="radio" name="format" id="csv">
                    Comma-separated (CSV)
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-success" onclick="return navMap.downloadView()">Download Data</button>
          </div>
        </div>
      </div>
    </div><!-- end download modal -->

    <div class="modal fade" id="collectionBox" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="collectionName"></h4>
          </div>
          <div class="modal-body" id="collectionModalBody"></div>
        </div>
      </div>
    </div><!-- end collectionBox modal -->

     <div class="modal fade" id="gPlatesBox" tabindex="-1" role="dialog" aria-labelledby="GPlatesInfo" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title">About GPlates</h4>
            <p class="text-muted"><a href="http://gplates.org">gplates.org</a></p>
          </div>
          <div class="modal-body">
            <h4>Current rotation:</h4>
            <table class="table">
              <tr>
                <td style="border-top:0;"><strong>Rotation interval</strong></td>
                <td id="rotationInterval" style="border-top:0;"></td>
              </tr>
              <tr>
                <td><strong>Rotation year</strong></td>
                <td id="rotationYear"></td>
              </tr>
              <tr>
                <td><strong>Reference</strong></td>
                <td id="rotationReference"></td>
              </tr>
            </table>

          </div>
        </div>
      </div>
    </div><!-- end gPlatesBox modal -->


    <div class="modal fade" id="collectionModal" tabindex="-1" role="dialog" aria-labelledby="BinInfo" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="binID"></h4>
          </div>
          <div class="modal-body">
            <h4>Collections</h4>
            <div class="panel-group" id="accordion"></div>
          </div>
        </div>
      </div>
    </div><!-- end collectionModal -->

    <div class="modal fade" id="subtaxaModal" tabindex="-1" role="dialog" aria-labelledby="Subtaxa" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header" id="subtaxaModalHeader">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          </div>
          <div class="modal-body">
            <table class="table table-hover table-condensed">
              <tbody id="subtaxaModalTable"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div><!-- end subtaxaModal -->
    

    <script src="http://cdn.leafletjs.com/leaflet-0.6.3/leaflet.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script src="http://d3js.org/d3.geo.projection.v0.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/typeahead.min.js"></script>
    <script src="js/mustache.js"></script>
    <script src="js/timescale.js"></script>
    <script src="js/reconstruct.js"></script>
    <script src="js/taxaBrowser.js"></script>
    <script src="js/navMap.js"></script>
  </body>
</html>